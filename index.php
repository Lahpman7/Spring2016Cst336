<?php
$cards= array(
         array("Suite"=>"Clubs",
          "Value"=>1,
          "Face"=>"Ace",
          "Picture"=>"./assets/cards/clubs/1.png"),
          array("Suite"=>"Clubs",
          "Value"=>2,
          "Face"=>"Two",
          "Picture"=>"./assets/cards/clubs/2.png"),
          array("Suite"=>"Clubs",
          "Value"=>3,
          "Face"=>"Three",
          "Picture"=>"./assets/cards/clubs/3.png"),
          array("Suite"=>"Clubs",
          "Value"=>4,
          "Face"=>"Four",
          "Picture"=>"./assets/cards/clubs/4.png"),
          array("Suite"=>"Clubs",
          "Value"=>5,
          "Face"=>"Five",
          "Picture"=>"./assets/cards/clubs/5.png"),
          array("Suite"=>"Clubs",
          "Value"=>6,
          "Face"=>"Six",
          "Picture"=>"./assets/cards/clubs/6.png"),
          array("Suite"=>"Clubs",
          "Value"=>7,
          "Face"=>"Seven",
          "Picture"=>"./assets/cards/clubs/7.png"),
          array("Suite"=>"Clubs",
          "Value"=>8,
          "Face"=>"Eight",
          "Picture"=>"./assets/cards/clubs/8.png"),
          array("Suite"=>"Clubs",
          "Value"=>9,
          "Face"=>"Nine",
          "Picture"=>"./assets/cards/clubs/9.png"),
          array("Suite"=>"Clubs",
          "Value"=>10,
          "Face"=>"Ten",
          "Picture"=>"./assets/cards/clubs/10.png"),
          array("Suite"=>"Clubs",
          "Value"=>11,
          "Face"=>"Jack",
          "Picture"=>"./assets/cards/clubs/11.png"),
          array("Suite"=>"Clubs",
          "Value"=>12,
          "Face"=>"Queen",
          "Picture"=>"./assets/cards/clubs/12.png"),
          array("Suite"=>"Clubs",
          "Value"=>13,
          "Face"=>"King",
          "Picture"=>"./assets/cards/clubs/13.png"),
          array("Suite"=>"Diamonds",
          "Value"=>1,
          "Face"=>"Ace",
          "Picture"=>"./assets/cards/diamonds/1.png"),
          array("Suite"=>"Diamonds",
          "Value"=>2,
          "Face"=>"Two",
          "Picture"=>"./assets/cards/diamonds/2.png"),
          array("Suite"=>"Diamonds",
          "Value"=>3,
          "Face"=>"Three",
          "Picture"=>"./assets/cards/diamonds/3.png"),
          array("Suite"=>"Diamonds",
          "Value"=>4,
          "Face"=>"Four",
          "Picture"=>"./assets/cards/diamonds/4.png"),
          array("Suite"=>"Diamonds",
          "Value"=>5,
          "Face"=>"Five",
          "Picture"=>"./assets/cards/diamonds/5.png"),
          array("Suite"=>"Diamonds",
          "Value"=>6,
          "Face"=>"Six",
          "Picture"=>"./assets/cards/diamonds/6.png"),
          array("Suite"=>"Diamonds",
          "Value"=>7,
          "Face"=>"Seven",
          "Picture"=>"./assets/cards/diamonds/7.png"),
          array("Suite"=>"Diamonds",
          "Value"=>8,
          "Face"=>"Eight",
          "Picture"=>"./assets/cards/diamonds/8.png"),
          array("Suite"=>"Diamonds",
          "Value"=>9,
          "Face"=>"Nine",
          "Picture"=>"./assets/cards/diamonds/9.png"),
          array("Suite"=>"Diamonds",
          "Value"=>10,
          "Face"=>"Ten",
          "Picture"=>"./assets/cards/diamonds/10.png"),
          array("Suite"=>"Diamonds",
          "Value"=>11,
          "Face"=>"Jack",
          "Picture"=>"./assets/cards/diamonds/11.png"),
          array("Suite"=>"Diamonds",
          "Value"=>12,
          "Face"=>"Queen",
          "Picture"=>"./assets/cards/diamonds/12.png"),
          array("Suite"=>"Diamonds",
          "Value"=>13,
          "Face"=>"King",
          "Picture"=>"./assets/cards/diamonds/13.png"),
          array("Suite"=>"Hearts",
          "Value"=>1,
          "Face"=>"Ace",
          "Picture"=>"./assets/cards/hearts/1.png"),
          array("Suite"=>"Hearts",
          "Value"=>2,
          "Face"=>"Two",
          "Picture"=>"./assets/cards/hearts/2.png"),
          array("Suite"=>"Hearts",
          "Value"=>3,
          "Face"=>"Three",
          "Picture"=>"./assets/cards/hearts/3.png"),
          array("Suite"=>"Hearts",
          "Value"=>4,
          "Face"=>"Four",
          "Picture"=>"./assets/cards/hearts/4.png"),
          array("Suite"=>"Hearts",
          "Value"=>5,
          "Face"=>"Five",
          "Picture"=>"./assets/cards/hearts/5.png"),
          array("Suite"=>"Hearts",
          "Value"=>6,
          "Face"=>"Six",
          "Picture"=>"./assets/cards/hearts/6.png"),
          array("Suite"=>"Hearts",
          "Value"=>7,
          "Face"=>"Seven",
          "Picture"=>"./assets/cards/hearts/7.png"),
          array("Suite"=>"Hearts",
          "Value"=>8,
          "Face"=>"Eight",
          "Picture"=>"./assets/cards/hearts/8.png"),
          array("Suite"=>"Hearts",
          "Value"=>9,
          "Face"=>"Nine",
          "Picture"=>"./assets/cards/hearts/9.png"),
          array("Suite"=>"Hearts",
          "Value"=>10,
          "Face"=>"Ten",
          "Picture"=>"./assets/cards/hearts/10.png"),
          array("Suite"=>"Hearts",
          "Value"=>11,
          "Face"=>"Jack",
          "Picture"=>"./assets/cards/hearts/11.png"),
          array("Suite"=>"Hearts",
          "Value"=>12,
          "Face"=>"Queen",
          "Picture"=>"./assets/cards/hearts/12.png"),
          array("Suite"=>"Hearts",
          "Value"=>13,
          "Face"=>"King",
          "Picture"=>"./assets/cards/hearts/13.png"),
          array("Suite"=>"Spades",
          "Value"=>1,
          "Face"=>"Ace",
          "Picture"=>"./assets/cards/spades/1.png"),
          array("Suite"=>"Spades",
          "Value"=>2,
          "Face"=>"Two",
          "Picture"=>"./assets/cards/spades/2.png"),
          array("Suite"=>"Spades",
          "Value"=>3,
          "Face"=>"Three",
          "Picture"=>"./assets/cards/spades/3.png"),
          array("Suite"=>"Spades",
          "Value"=>4,
          "Face"=>"Four",
          "Picture"=>"./assets/cards/spades/4.png"),
          array("Suite"=>"Spades",
          "Value"=>5,
          "Face"=>"Five",
          "Picture"=>"./assets/cards/spades/5.png"),
          array("Suite"=>"Spades",
          "Value"=>6,
          "Face"=>"Six",
          "Picture"=>"./assets/cards/spades/6.png"),
          array("Suite"=>"Spades",
          "Value"=>7,
          "Face"=>"Seven",
          "Picture"=>"./assets/cards/spades/7.png"),
          array("Suite"=>"Spades",
          "Value"=>8,
          "Face"=>"Eight",
          "Picture"=>"./assets/cards/spades/8.png"),
          array("Suite"=>"Spades",
          "Value"=>9,
          "Face"=>"Nine",
          "Picture"=>"./assets/cards/spades/9.png"),
          array("Suite"=>"Spades",
          "Value"=>10,
          "Face"=>"Ten",
          "Picture"=>"./assets/cards/spades/10.png"),
          array("Suite"=>"Spades",
          "Value"=>11,
          "Face"=>"Jack",
          "Picture"=>"./assets/cards/spades/11.png"),
          array("Suite"=>"Spades",
          "Value"=>12,
          "Face"=>"Queen",
          "Picture"=>"./assets/cards/spades/12.png"),
          array("Suite"=>"Spades",
          "Value"=>13,
          "Face"=>"King",
          "Picture"=>"./assets/cards/spades/13.png"),
          
    );

   $checker = array(0,0,0,0,0);
  
    $players = array(
    array("Name"=>"John",
        "Image" => randPic(),
        "Hand" =>array(),
        "Score"=> 0,
        'Outcome'=> '  '),
    array("Name"=>"Joe",
        "Image"=> randPic(),
        "Hand" =>array(),
        "Score"=> 0,
        "Outcome"=>'  '),
    array("Name" => "Jane",
        "Image"=>randPic(),
        "Hand" =>array(),
        "Score"=> 0,
        'Outcome'=> '  '),
    array("Name" => "Jerry",
        "Image"=>randPic(),
        "Hand" =>array(),
        "Score"=> 0,
        "Outcome"=>'  ')
    
    );
   
    $tab =array("Players"=>$players,
                  "Deck"=>array());
function randPic() 
{
  global $checker;
   $picker= rand(1,4);
   while(1)
   {
     for($i=0;$i<5;$i++)
     {
         if($checker[$i]!=1 &&$i==$picker)
         {
             $checker[$i]=1;
           return "./assets/players/face$picker.png";   
         }
         else{
             $picker=(rand(1,4));
         }
  
     }
   }
   
}

function game($cards,$tabl,$tableCount)
{
  $deck=$cards;//assigns
  shuffle($deck);
  shuffle($deck);
  shuffle($deck);
  $table=$tabl;
  $table["Deck"]=$deck;
  for($i=0;$i<$tableCount;$i++)
  {
  $table = dealHand($table,$i);
  }

  printTable($table);
  
}
function dealHand($play,$seat)
{
   
  $numCards= rand(4,6);
  for($i=0;$i<$numCards;$i++)
  {
     array_push($play["Players"][$seat]["Hand"],$play["Deck"][$i] );
     unset($play["Deck"][$i]);
    $play["Players"][$seat]["Score"] +=$play["Players"][$seat]["Hand"][$i]["Value"];
  }

  $play["Deck"]=array_values($play["Deck"]);

  
return $play; 
}
function printHand($hand)
{
    $length=count($hand);
  
   for($i=0;$i<6;$i++)
   {
        if($i<$length)
        {
       echo '<td><img src='.$hand[$i]["Picture"].'></td>';
        }
        else{
            echo"<td></td>";
        
        }
    
   }
  
    
}

function closestNum($mesa, $arr)
{
    $max = 0;
    for($o = 0; $o<4; $o++)
    {
       if($mesa['Players'][$o]['Score']  >= $max && $mesa['Players'][$o]['Score'] <= 42 )
        {
            $max = $mesa['Players'][$o]['Score'];
        }
        else
        $max=$max;
    }
    
    for($o = 0; $o<4; $o++)
    {
     if($mesa['Players'][$o]['Score']  == $max)
        {

            $arr[$o] = 'Winner';
            return $arr;
        }
    }
}
function printTable($printme)
{
    $arr = array('','','','');
    //printme will hold complete array
    //table formatting in progress
      for($x = 0 ; $x < 4; $x++)
        {
            if($printme['Players'][$x]['Score'] > 42)
            {
               
                $arr[$x] = 'Bust';
            }
            else{
               $arr = closestNum($printme,$arr);
            }
        }
       
       echo"<form >";
       echo "<table  >

            <tr >
            <td class='hed' align = 'center'>SILVER JACK</td>
              </tr>
            <tr>

            </tr>";
               //player1
              echo "<tr>";
              echo "<td>" . "John" . "</td>";
              echo "<td>" . '<img src='.$printme['Players'][0]["Image"].'>' . "</td>"; 
              echo "<td id = 'teedee'>" . printHand($printme['Players'][0]['Hand']). "</td>";
              echo "<td>" . $printme['Players'][0]['Score'] . "</td>";
              echo "<td>" . $arr[0]. '</td>';

              echo "</tr>";
              //player 2
              echo "<tr>";
              echo "<td>" . "Joe" . "</td>";
              echo "<td>" . '<img src='.$printme['Players'][1]["Image"].'>' . "</td>";
              echo "<td id = 'teedee'>" . printHand($printme['Players'][1]['Hand']). "</td>";
              echo "<td>" . $printme['Players'][1]['Score'] . "</td>";
              echo "<td>" . $arr[1]. '</td>';

              echo "</tr>";
              //player 3
              echo "<tr>";
              echo "<td>" . "Jane" . "</td>";
              echo "<td>" . '<img src='.$printme['Players'][2]["Image"].'>' . "</td>";
              echo "<td id = 'teedee'>" . printHand($printme['Players'][2]['Hand']). "</td>";
              echo "<td>" . $printme['Players'][2]['Score'] . "</td>";
              echo "<td>" . $arr[2]. '</td>';

              echo "</tr>";
              //player 4
              echo "<tr>";
              echo "<td>" . "Jerry" . "</td>";
              echo "<td>" . '<img src='.$printme['Players'][3]["Image"].'>' . "</td>";
              echo "<td id = 'teedee'>" . printHand($printme['Players'][3]['Hand']). "</td>";
              echo "<td>" . $printme['Players'][3]['Score'] . "</td>";
              echo "<td>" . $arr[3]. '</td>';
              
              echo "</tr>";
              
              echo"<tr class ='button'>";
              echo"<td><input  type='reset' value='Play Again' onClick='window.location.reload()'></td>";
              echo"</tr>";
              
    echo "</table>";
    echo"</form>";

}

?>
<!DOCTYPE html>
<html>

<head>
    <title>Game</title>
    <link rel="stylesheet" type="text/css" href="./css/main.css">

</head>

<body>
    <?php
    game($cards,$tab,4);
    ?>
    <footer>
    
    </footer>
</body>

</html>